labels_sx = [[3, 3, 2, 1], # Thickness	Density	Stiffness	Stretchiness
[1, 2, 4, 0],
[4, 3, 2, 1],
[3, 2, 2, 1],
[3, 3, 4, 0],
[2, 3, 4, 0],
[2, 3, 4, 0],
[2, 4, 4, 0],
[2, 4, 2, 1],
[3, 2, 2, 1],
[5, 2, 1, 1],
[2, 3, 4, 0],
[1, 1, 4, 0],
[2, 2, 3, 0],
[4, 3, 2, 1],
[3, 2, 2, 1],
[2, 3, 4, 0],
[3, 3, 4, 0],
[3, 2, 2, 1],
[3, 2, 2, 1],
[2, 3, 4, 0],
[3, 4, 2, 1],
[4, 4, 3, 0],
[2, 3, 4, 0],
[5, 3, 3, 1],
[2, 2, 4, 0],
[1, 1, 4, 0],
[4, 2, 2, 1],
[2, 3, 4, 0],
[3, 2, 2, 1],
[3, 2, 2, 1],
[3, 2, 2, 1],
[2, 3, 4, 0],
[2, 3, 3, 0],
[5, 2, 1, 1],
[1, 1, 2, 0],
[4, 2, 3, 0],
[2, 2, 3, 1],
[5, 3, 3, 1],
[2, 3, 4, 0],
[3, 2, 3, 1],
[3, 2, 3, 0],
[2, 3, 4, 0],
[2, 3, 5, 1],
[2, 2, 4, 0],
[2, 2, 4, 0],
[2, 2, 5, 0],
[2, 3, 5, 0],
[4, 3, 3, 0],
[3, 3, 2, 0],
[4, 4, 5, 0],
[3, 3, 2, 0],
[2, 2, 4, 0],
[5, 5, 1, 1],
[2, 4, 5, 0],
[2, 2, 4, 0],
[5, 2, 3, 0],
[5, 2, 3, 1],
[1, 2, 3, 0],
[4, 4, 3, 0],
[2, 4, 4, 0],
[5, 4, 5, 1],
[1, 1, 4, 0],
[2, 2, 3, 0],
[5, 4, 4, 0],
[2, 3, 5, 0],
[3, 2, 3, 0],
[5, 4, 5, 0],
[1, 1, 4, 0],
[5, 4, 5, 0],
[5, 3, 1, 1],
[1, 4, 2, 0],
[1, 3, 3, 0],
[5, 4, 1, 0],
[2, 4, 2, 1],
[3, 4, 3, 0],
[2, 2, 4, 0],
[1, 1, 2, 1],
[3, 4, 2, 0],
[2, 1, 5, 0],
[2, 2, 3, 0],
[5, 3, 1, 0],
[5, 2, 1, 0],
[5, 2, 1, 0],
[5, 5, 5, 0],
[3, 4, 2, 0],
[3, 3, 5, 0],
[5, 4, 4, 0],
[3, 3, 3, 0],
[3, 3, 2, 1],
[5, 4, 1, 0],
[5, 4, 2, 0],
[1, 1, 2, 0],
[2, 3, 3, 0],
[5, 4, 5, 0],
[2, 3, 3, 0],
[2, 2, 4, 0],
[2, 2, 4, 0],
[2, 3, 4, 1],
[5, 5, 1, 1]]

labels_wz = [[2.8, 3, 2, 1],
[0.8, 2, 2.4, 0],
[2.1, 3, 1.6, 1],
[2.4, 2, 1.4, 1],
[1.4, 3, 3.3, 0],
[2, 3, 4, 0],
[2, 3, 3.5, 0],
[3, 4, 5, 0],
[2.2, 4, 1.6, 1],
[4, 2, 1.3, 1],
[8, 2, 2.8, 1],
[1.4, 3, 3.4, 0],
[1.3, 1, 2.8, 0],
[1.6, 2, 2, 0],
[4.7, 3, 1.5, 1],
[3, 2, 1, 1],
[2.5, 3, 3.3, 0],
[2.7, 3, 2.8, 0],
[2, 2, 1, 1],
[3, 2, 1, 1],
[1.4, 3, 3.9, 0],
[3, 4, 1, 1],
[1.5, 4, 2.5, 0],
[1.5, 3, 3.9, 0],
[5, 3, 2.9, 1],
[2, 2, 3.6, 0],
[1, 1, 3.5, 0],
[4.6, 2, 1.2, 1],
[2, 3, 4, 0],
[3, 2, 1, 1],
[3, 2, 1, 1],
[4, 2, 1.2, 1],
[2, 3, 3.8, 0],
[2.4, 3, 2.8, 0],
[7.2, 2, 2.8, 1],
[0.5, 1, 0.9, 0],
[5, 2, 3.3, 0],
[1.8, 2, 2.8, 1],
[5, 3, 3.3, 1],
[2.2, 3, 3, 0],
[3, 2, 3, 1],
[3, 2, 3, 0],
[2, 3, 2.8, 0],
[2, 3, 4.2, 1],
[2.2, 2, 2.6, 0],
[2, 2, 3.3, 0],
[3, 2, 4.5, 0],
[2, 3, 4.2, 0],
[1.8, 3, 2.6, 0],
[2.4, 3, 1.7, 0],
[2.8, 4, 4.8, 0],
[2.4, 3, 2, 0],
[1.5, 2, 4, 0],
[6.5, 5, 2.8, 1],
[3, 4, 3.3, 0],
[1.3, 2, 3.1, 0],
[5.5, 2, 2.5, 0],
[8, 2, 3.3, 1],
[1, 2, 2.5, 0],
[4.5, 4, 3.3, 0],
[1.9, 4, 4.4, 0],
[3, 4, 4, 1],
[1.3, 1, 4, 0],
[1.7, 2, 2.3, 0],
[5.4, 4, 3.5, 0],
[2.6, 3, 5.4, 0],
[2.5, 2, 2.6, 0],
[5.4, 4, 5.5, 0],
[1.5, 1, 4.6, 0],
[5, 4, 5, 0],
[6, 3, 2.8, 1],
[1.8, 4, 2.1, 0],
[1.5, 3, 2.1, 0],
[6, 4, 2.6, 0],
[2.2, 4, 1.8, 1],
[2.6, 4, 3.4, 0],
[2.2, 2, 4, 0],
[1.4, 1, 1.7, 1],
[2.2, 4, 2, 0],
[2.2, 1, 4.5, 0],
[1.9, 2, 3.6, 0],
[6.5, 3, 2.9, 0],
[6.5, 2, 2.7, 0],
[7, 2, 2.8, 0],
[5.5, 5, 4.8, 0],
[3, 4, 3, 0],
[2.4, 3, 5.3, 0],
[4, 4, 4.5, 0],
[2.6, 3, 4.7, 0],
[2, 3, 2.3, 1],
[3, 4, 3.3, 0],
[4.5, 4, 4.5, 0],
[0.8, 1, 1.1, 0],
[2, 3, 2.8, 0],
[5, 4, 5, 0],
[1.5, 3, 2.1, 0],
[1, 2, 2.3, 0],
[1.3, 2, 3.3, 0],
[3, 3, 4.5, 1],
[12, 5, 2.3, 1]]

labels = [[2.8, 2.445652174, 2, 1],
[0.8, 0.413995726, 2.4, 0],
[2.1, 1.431888545, 1.6, 1],
[2.4, 1.299621928, 1.4, 1],
[1.4, 1.032686782, 3.3, 1],
[2, 1.5704154, 4, 1],
[2, 1.877289377, 3.5, 0],
[3, 2.294921875, 5, 0],
[2.2, 1.998050682, 1.6, 1],
[4, 1.539855072, 1.3, 1],
[8, 2.21345606, 2.8, 1],
[1.4, 1.035714286, 3.4, 0.5],
[1.3, 0.620791246, 2.8, 0],
[1.6, 0.972222222, 2, 0.5],
[4.7, 1.961500975, 1.5, 1],
[3, 1.276315789, 1, 1],
[2.5, 1.738721805, 3.3, 1],
[2.7, 1.349527665, 2.8, 0],
[2, 1.059670782, 1, 1],
[3, 1.26705653, 1, 1],
[1.4, 1.108333333, 3.9, 0.5],
[3, 1.855263158, 1, 1],
[1.5, 1.661036036, 2.5, 0],
[1.5, 1.065962099, 3.9, 0.5],
[5, 1.543209877, 2.9, 1],
[2, 1.502403846, 3.6, 0],
[1, 0.513157895, 3.5, 0],
[4.6, 1.816239316, 1.2, 1],
[2, 1.277173913, 4, 0.5],
[3, 1.258581236, 1, 1],
[3, 1.315789474, 1, 1],
[4, 1.539003759, 1.2, 1],
[2, 1.385946328, 3.8, 0.5],
[2.4, 1.754385965, 2.8, 0],
[7.2, 2.222222222, 2.8, 1],
[0.5, 0.421626984, 0.9, 0],
[5, 1.405508072, 3.3, 1],
[1.8, 1.467331118, 2.8, 0],
[5, 1.498397436, 3.3, 1],
[2.2, 1.535714286, 3, 0],
[3, 1.439144737, 3, 0],
[3, 1.362179487, 3, 1],
[2, 1.401564537, 2.8, 0],
[2, 1.413690476, 4.2, 0.5],
[2.2, 1.658615137, 2.6, 0],
[2, 1.767381417, 3.3, 0],
[3, 2.446338384, 4.5, 0],
[2, 1.966145833, 4.2, 1],
[1.8, 1.595982143, 2.6, 0],
[2.4, 2.373333333, 1.7, 1],
[2.8, 2.75, 4.8, 0],
[2.4, 2.118844697, 2, 0],
[1.5, 0.960847701, 4, 0],
[6.5, 2.916666667, 2.8, 0.5],
[3, 2.405278842, 3.3, 0],
[1.3, 0.837104072, 3.1, 0],
[5.5, 1.231617647, 2.5, 0],
[8, 2.307692308, 3.3, 1],
[1, 0.568181818, 2.5, 0],
[4.5, 1.975384615, 3.3, 1],
[1.9, 2.152777778, 4.4, 0],
[3, 2.381756757, 4, 0],
[1.3, 0.197916667, 4, 0],
[1.7, 1.011494253, 2.3, 1],
[5.4, 3.454614604, 3.5, 0],
[2.6, 2.795385396, 5.4, 0],
[2.5, 1.375507099, 2.6, 0],
[5.4, 4.811105477, 5.5, 0],
[1.5, 0.589503043, 4.6, 0],
[5, 3.372210953, 5, 0.5],
[6, 1.945993915, 2.8, 0.5],
[1.8, 0.805020284, 2.1, 0],
[1.5, 0.90010142, 2.1, 0],
[6, 2.472109533, 2.6, 1],
[2.2, 2.25025355, 1.8, 1],
[2.6, 1.464249493, 3.4, 1],
[2.2, 1.489604462, 4, 0.5],
[1.4, 0.678245436, 1.7, 0],
[2.2, 1.597363083, 2, 1],
[2.2, 1.255070994, 4.5, 0],
[1.9, 1.381845842, 3.6, 0.5],
[6.5, 3.904665314, 2.9, 0.5],
[6.5, 1.597363083, 2.7, 1],
[7, 2.034736308, 2.8, 1],
[5.5, 4.950557809, 4.8, 0],
[3, 1.578346856, 3, 1],
[2.4, 2.028397566, 5.3, 0],
[4, 3.277129817, 4.5, 0],
[2.6, 1.762170385, 4.7, 0],
[2, 2.136156187, 2.3, 0.5],
[3, 3.074290061, 3.3, 0],
[4.5, 3.328402367, 4.5, 0],
[0.8, 0.350765306, 1.1, 0],
[2, 1.175059952, 2.8, 1],
[5, 4.075, 5, 0.5],
[1.5, 1.282051282, 2.1, 0],
[1, 1.095679012, 2.3, 0],
[1.3, 0.661375661, 3.3, 0],
[3, 1.729452055, 4.5, 1],
[12, 2.477678571, 2.3, 1]]

# labels = [[0.58, 2.445652174, 2, 1],
# [0.12, 0.413995726, 2.4, 0],
# [0.35, 1.431888545, 1.6, 1],
# [0.38, 1.299621928, 1.4, 1],
# [0.26, 1.032686782, 3.3, 1],
# [0.36, 1.5704154, 4, 1],
# [0.34, 1.877289377, 3.5, 0],
# [0.45, 2.294921875, 5, 0],
# [0.43, 1.998050682, 1.6, 1],
# [0.53, 1.539855072, 1.3, 1],
# [0.93, 2.21345606, 2.8, 1],
# [0.26, 1.035714286, 3.4, 0.5],
# [0.12, 0.620791246, 2.8, 0],
# [0.23, 0.972222222, 2, 0.5],
# [0.55, 1.961500975, 1.5, 1],
# [0.35, 1.276315789, 1, 1],
# [0.37, 1.738721805, 3.3, 1],
# [0.38, 1.349527665, 2.8, 0],
# [0.36, 1.059670782, 1, 1],
# [0.41, 1.26705653, 1, 1],
# [0.24, 1.108333333, 3.9, 0.5],
# [0.42, 1.855263158, 1, 1],
# [0.67, 1.661036036, 2.5, 0],
# [0.24, 1.065962099, 3.9, 0.5],
# [0.48, 1.543209877, 2.9, 1],
# [0.37, 1.502403846, 3.6, 0],
# [0.09, 0.513157895, 3.5, 0],
# [0.5, 1.816239316, 1.2, 1],
# [0.29, 1.277173913, 4, 0.5],
# [0.5, 1.258581236, 1, 1],
# [0.45, 1.315789474, 1, 1],
# [0.47, 1.539003759, 1.2, 1],
# [0.3, 1.385946328, 3.8, 0.5],
# [0.33, 1.754385965, 2.8, 0],
# [1.08, 2.222222222, 2.8, 1],
# [0.08, 0.421626984, 0.9, 0],
# [0.5, 1.405508072, 3.3, 1],
# [0.3, 1.467331118, 2.8, 0],
# [0.58, 1.498397436, 3.3, 1],
# [0.26, 1.535714286, 3, 0],
# [0.38, 1.439144737, 3, 0],
# [0.37, 1.362179487, 3, 1],
# [0.2, 1.401564537, 2.8, 0],
# [0.29, 1.413690476, 4.2, 0.5],
# [0.44, 1.658615137, 2.6, 0],
# [0.37, 1.767381417, 3.3, 0],
# [0.63, 2.446338384, 4.5, 0],
# [0.37, 1.966145833, 4.2, 1],
# [0.3, 1.595982143, 2.6, 0],
# [0.51, 2.373333333, 1.7, 1],
# [0.58, 2.75, 4.8, 0],
# [0.47, 2.118844697, 2, 0],
# [0.2, 0.960847701, 4, 0],
# [0.94, 2.916666667, 2.8, 0.5],
# [0.48, 2.405278842, 3.3, 0],
# [0.11, 0.837104072, 3.1, 0],
# [0.43, 1.231617647, 2.5, 0],
# [1.32, 2.307692308, 3.3, 1],
# [0.19, 0.568181818, 2.5, 0],
# [0.47, 1.975384615, 3.3, 1],
# [0.21, 2.152777778, 4.4, 0],
# [0.62, 2.381756757, 4, 0],
# [0.12, 0.197916667, 4, 0],
# [0.21, 1.011494253, 2.3, 1],
# [0.96, 3.454614604, 3.5, 0],
# [0.63, 2.795385396, 5.4, 0],
# [0.38, 1.375507099, 2.6, 0],
# [0.98, 4.811105477, 5.5, 0],
# [0.1, 0.589503043, 4.6, 0],
# [1.06, 3.372210953, 5, 0.5],
# [0.69, 1.945993915, 2.8, 0.5],
# [0.23, 0.805020284, 2.1, 0],
# [0.26, 0.90010142, 2.1, 0],
# [0.5, 2.472109533, 2.6, 1],
# [0.45, 2.25025355, 1.8, 1],
# [0.37, 1.464249493, 3.4, 1],
# [0.26, 1.489604462, 4, 0.5],
# [0.17, 0.678245436, 1.7, 0],
# [0.4, 1.597363083, 2, 1],
# [0.31, 1.255070994, 4.5, 0],
# [0.51, 1.381845842, 3.6, 0.5],
# [1.32, 3.904665314, 2.9, 0.5],
# [0.69, 1.597363083, 2.7, 1],
# [0.74, 2.034736308, 2.8, 1],
# [1.41, 4.950557809, 4.8, 0],
# [0.53, 1.578346856, 3, 1],
# [0.39, 2.028397566, 5.3, 0],
# [0.74, 3.277129817, 4.5, 0],
# [0.33, 1.762170385, 4.7, 0],
# [0.44, 2.136156187, 2.3, 0.5],
# [0.91, 3.074290061, 3.3, 0],
# [1.12, 3.328402367, 4.5, 0],
# [0.08, 0.350765306, 1.1, 0],
# [0.3, 1.175059952, 2.8, 1],
# [0.96, 4.075, 5, 0.5],
# [0.35, 1.282051282, 2.1, 0],
# [0.16, 1.095679012, 2.3, 0],
# [0.13, 0.661375661, 3.3, 0],
# [0.44, 1.729452055, 4.5, 1],
# [0.87, 2.477678571, 2.3, 1]]

from sklearn.cluster import KMeans
import numpy as np


physical = np.array(labels,dtype='float')

# physical[:,0] = physical[:,0] * 7
# physical[:,0] = physical[:,0] / np.max(physical[:,0])
# physical[:,1] = physical[:,1] / np.max(physical[:,1])
# physical[:,2] = physical[:,2] / np.max(physical[:,2])
labels = physical


if __name__ == '__main__':

    K = 12
    cluster = KMeans(K, random_state=0)

    embedding = np.array(labels,dtype='float')
    cluster.fit(embedding)
    pred = cluster.predict(embedding)
    res = [[] for i in range(K)]
    for i in range(100):
        res[pred[i]].append(i)
    fin = open('/Users/shawn/Code/google-image-layout/index.html','r')
    fout = open('/Users/shawn/Code/google-image-layout/pic.html','w')
    lines = fin.readlines()
    for k in range(len(lines)):
        print >>fout, lines[k].rstrip()
        if lines[k].find('content begin') != -1:
            break

    classes = [0 for i in range(100)]
    for i in range(len(res)):
        # print set(res[i]), np.average(embedding[res[i]],axis=0)
        print >>fout, '<div class="google-image-layout" data-google-image-layout data-max-height="150">'
        print >>fout, ['%s=%.2lf' % (['Thickness','Density','Stiffness','Stretchiness'][j], np.average(embedding[res[i]],axis=0)[j]) for j in range(4)]
        print >>fout, '<br/>'
        print res[i]
        for j in res[i]:
            classes[j] = i
            print >>fout, '<img src="/Users/shawn/Dropbox (MIT)/GelSight/Shared/Project/Fabric/data/resize/Canon/F%04d_1.JPG"/>' % (j+1)
            print >>fout, 'F%04d' % (j+1)
        print >>fout, '</div>'
    for k in range(k, len(lines)):
        print >>fout, lines[k].rstrip()

    f_class = open('../../data/label/classes_12.txt', 'w')
    for i in classes:
        print >>f_class, i